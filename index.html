<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form</title>
    <link rel="icon" href="images/verify.png" type="icon">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header>
        <center>
            <span>Form</span>
        </center>
    </header>
    <main>
        <form id="sheetdb-form" action="https://sheetdb.io/api/v1/hcgr05t3qdd8d" method="post">
            <fieldset>
                <legend>Personal Details</legend>
                <label for="fName">First Name</label>
                <input type="text" name="data[fName]" id="fName" placeholder="First Name" required
                    pattern="[a-zA-Z\s]{1,9}">
                <label for="mName">Middle Name</label>
                <input type="text" name="data[mName]" id="mName" placeholder="Middle Name" pattern="[a-zA-z]{0,}">
                <label for="lName">Last Name</label>
                <input type="text" name="data[lName]" id="lName" placeholder="Last Name" required
                    pattern="[a-zA-Z\s]{1,9}">
                <label for="Emial">E-Mail</label>
                <input type="email" name="data[email]" id="email" placeholder="Email" required>
                <label for="phoneNumber">Phone Number</label>
                <input type="text" name="data[phoneNumber]" id="phoneNumber" placeholder="Phone Number" required
                    pattern="[0-9]{10,10}">
                <label for="DOB">Date of Birth</label>
                <input type="date" name="data[DOB]" id="DOB" required>
                <input type="hidden" name="data[dateOfBirth(mm-dd-yyyy)]" id="dateOfBirth" value="">
                <label for="Address">Address</label>
                <input type="text" name="data[Address]" id="Address" required>
            </fieldset>
            <fieldset class="Educational">
                <legend>Educational details</legend>
                <label for="CollegeName">College Name</label>
                <div>
                    <select name="data[clgname]" id="clgname" required>
                        <option selected></option>
                        <option>B M S College of Engineering</option>
                        <option>Dayananda Sagar College of Engineering</option>
                        <option>Dr. Ambedkar Institute Of Technology</option>
                        <option>M S Ramaiah Institute of Technology</option>
                        <option>Malnad College of Engineering</option>
                        <option>Others</option>
                        <option>PESITM</option>
                        <option>R. V. College of Engineering</option>
                        <option>RNIST</option>
                        <option>S J C Institute of Technology</option>
                    </select>
                </div>
                <label for="department">Branch / Stream</label>
                <div class="department">
                    <div>
                        <input type="radio" id="cse" name="data[department]" value="CSE" checked required>
                        <label for="cse">CSE</label>
                    </div>
                    <div>
                        <input type="radio" id="cvl" name="data[department]" value="CVL">
                        <label for="cvl">CVL</label>
                    </div>
                    <div>
                        <input type="radio" id="ece" name="data[department]" value="ECE">
                        <label for="ece">ECE</label>
                    </div>
                    <div>
                        <input type="radio" id="eee" name="data[department]" value="EEE">
                        <label for="eee">EEE</label>
                    </div>
                    <div>
                        <input type="radio" id="ise" name="data[department]" value="ISE">
                        <label for="ise">ISE</label>
                    </div>
                    <div>
                        <input type="radio" id="mech" name="data[department]" value="MECH">
                        <label for="mech">MECH</label>
                    </div>
                </div>

                <label for="CGPA">CGPA</label>
                <input type="range" id="CGPA" name="data[CGPA]" min="0" max="10" step="0.5" list="markers" required>
                <datalist id="markers">
                    <option value="0" label="0"></option>
                    <option value="1" label="1"></option>
                    <option value="2" label="2"></option>
                    <option value="3" label="3"></option>
                    <option value="4" label="4"></option>
                    <option value="5" label="5"></option>
                    <option value="6" label="6"></option>
                    <option value="7" label="7"></option>
                    <option value="8" label="8"></option>
                    <option value="9" label="9"></option>
                    <option value="10" label="10"></option>
                </datalist>
                <label for="yog" name="yog">Year of graduation</label>
                <div>
                    <select name="data[yog]" id="yog" required>
                        <option selected></option>
                        <option>2017</option>
                        <option>2018</option>
                        <option>2019</option>
                        <option>2020</option>
                        <option>2021</option>
                        <option>2022</option>
                        <option>2023</option>
                        <option>2024</option>
                        <option>2025</option>
                        <option>2026</option>
                        <option>2027</option>
                        <option>2028</option>
                    </select>
                </div>
                <label for="Skills">Skills</label>
                <div class="Skills" id="skills-container">
                    <input type="checkbox" id="HTML" value="html" name="data[HTML]">
                    <label for="HTML">HTML</label>
                    <input type="checkbox" id="CSS" value="css" name="data[CSS]">
                    <label for="CSS">CSS</label>
                    <input type="checkbox" id="JavaScript" value="JavaScript" name="data[JavaScript]">
                    <label for="JavaScript">JavaScript</label>
                    <input type="checkbox" id="C" value="c" name="data[C]">
                    <label for="C">C</label>
                    <input type="checkbox" id="c++" value="c++" name="data[C++]">
                    <label for="c++">C++</label>
                    <input type="checkbox" id="Python" value="python" name="data[Python]">
                    <label for="Python">Python</label>
                    <input type="checkbox" id="JAVA" value="java" name="data[JAVA]">
                    <label for="JAVA">JAVA</label>
                    <input type="checkbox" id="PHP" value="php" name="data[PHP]">
                    <label for="PHP">PHP</label>
                    <input type="checkbox" id="C#" value="c#" name="data[c#]">
                    <label for="C#">C#</label>
                    <input type="checkbox" id="Ruby" value="Ruby" name="data[Ruby]">
                    <label for="Ruby">Ruby</label>
                    <input type="checkbox" id="MiscrosoftOffice" value="msoffice" name="data[MiscrosoftOffice]">
                    <label for="MiscrosoftOffice">Miscrosoft Office</label>
                </div>
                <input type="hidden" name="data[skills]" id="selected-skills">
            </fieldset>
            <input type="submit">
        </form>
        <div class="popup" id="popup">
            <span>Thank you, Form Submitted</span>
            <div><button type="submit" value="X" name="ok" id="popsub">X</button></div>
        </div>
    </main>
    <footer>

    </footer>
    <script>
        var sub = document.getElementById("sheetdb-form");
        var pop = document.getElementById("popup");
        var skillsContainer = document.getElementById("skills-container");
        var selectedSkillsInput = document.getElementById("selected-skills");
        var formattedDOBInput = document.getElementById("dateOfBirth");

        var selectedDate = new Date(document.getElementById("DOB").value);
        var date = selectedDate.getDate() + "-" + selectedDate.getMonth() + "-" + selectedDate.getFullYear();
        formattedDOBInput.value = date;

        sub.addEventListener("submit", e => {
            e.preventDefault();
            pop.style.visibility = "visible";
            //checkboxes
            const selectedSkills = Array.from(skillsContainer.querySelectorAll("input[type=checkbox]:checked"))
                .map(checkbox => checkbox.value);
            selectedSkillsInput.value = JSON.stringify(selectedSkills);
            // date formatting
            var selectedDate = new Date(document.getElementById("DOB").value);
            //console.log(selectedDate)
            var formattedDOBInput = document.getElementById("dateOfBirth");
            const formattedDate =
                (selectedDate.getMonth() + 1).toString().padStart(2, '0') + '-' +
                selectedDate.getDate().toString().padStart(2, '0') + '-' +
                selectedDate.getFullYear();
            formattedDOBInput.value = formattedDate;
            //console.log(document.getElementById("dateOfBirth").value)
          
            fetch(sub.action, {
                method: "post",
                body: new FormData(document.getElementById("sheetdb-form")),
            }).then((response) => response.json());
        });

        var sub1 = document.getElementById("popsub");
        sub1.addEventListener("click", function (event) {
            event.preventDefault();
            pop.style.visibility = "hidden";
            sub.reset();
        });



    </script>
</body>

</html>